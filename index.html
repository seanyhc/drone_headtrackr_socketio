
<!DOCTYPE html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>Sean test socket io</title>
		<!-- // <script src="/socket.io/socket.io.js"></script> -->
		<script src="http://localhost:8000/socket.io/socket.io.js"></script>
		<script src="js/headtrackr.js"></script>
	</head>
	<body id="index" onload="">

		<canvas id="inputCanvas" width="320" height="240" style="display:none"></canvas>
		<video id="inputVideo" autoplay loop></video>

		<script>
		  var socket = io.connect('http://localhost:8000');
		  socket.on('news', function (data) {
		    console.log(data);
		    socket.emit('my other event', { my: 'data' });
		  });
		</script>

		<script type="text/javascript">
		  var videoInput = document.getElementById('inputVideo');
		  var canvasInput = document.getElementById('inputCanvas');

		  var htracker = new headtrackr.Tracker({'calcAngles': true});
		  htracker.init(videoInput, canvasInput);
		  htracker.start();

			function sleep(milliseconds) {
			  var start = new Date().getTime();
			  console.log('entering sleep');
			  for (var i = 0; i < 1e7; i++) {
			    if ((new Date().getTime() - start) > milliseconds){
			      break;
			    }
			  }
			  console.log('leaving sleep');
			}

			var state = 0;

			document.addEventListener("facetrackingEvent", function(event) {
				if(state == 0){
					return;
				}
				if (event.angle <= 1.35) {
				 	socket.emit('my other event', 'left');
				}
				else if (event.angle >= 1.85) {
				  socket.emit('my other event', 'right');
				  
				} else {
					socket.emit('my other event', 'hover');
				}
				sleep(500);
			});
		</script>
	</body>	
